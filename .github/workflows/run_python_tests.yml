name: Python PyTest Workflow

on:
  push:
    branches:
      - main
      - dev
  pull_request:
    branches:
      - main
      - dev

jobs:
  run_python_script:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v2

    - name: Set up Python
      uses: actions/setup-python@v2
      with:
        python-version: 3.8

    - name: Install Firefox browser
      run: |
        sudo apt-get update
        sudo apt-get install firefox -y

    - name: Get latest GeckoDriver version
      id: get_geckodriver_version
      run: |
        GECKODRIVER_VERSION=$(curl -sS https://api.github.com/repos/mozilla/geckodriver/releases/latest | jq -r .tag_name)
        echo "Latest GeckoDriver version: $GECKODRIVER_VERSION"
        echo "::set-output name=geckodriver_version::$GECKODRIVER_VERSION"

    - name: Download GeckoDriver
      run: |
        GECKODRIVER_VERSION=${{ steps.get_geckodriver_version.outputs.geckodriver_version }}
        wget https://github.com/mozilla/geckodriver/releases/download/${GECKODRIVER_VERSION}/geckodriver-${GECKODRIVER_VERSION}-linux64.tar.gz
        tar -xzf geckodriver-${GECKODRIVER_VERSION}-linux64.tar.gz
        sudo mv geckodriver /usr/local/bin/geckodriver
        sudo chmod +x /usr/local/bin/geckodriver

    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt  # If you have dependencies

    - name: Print contents of the root directory
      run: ls -al /

    - name: Run Python script
      run: python test_python.py
